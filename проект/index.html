<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>EcoOrbit AI - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ü–∞–≤–ª–æ–¥–∞—Ä–∞</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body { font-family: sans-serif; margin: 0; display: flex; height: 100vh; }
        #sidebar { width: 300px; background: #2c3e50; color: white; padding: 20px; z-index: 1000; overflow-y: auto; }
        #map { flex-grow: 1; }
        .stat-card { background: #34495e; padding: 15px; border-radius: 8px; margin-top: 20px; border-left: 5px solid #e74c3c; }
        .danger { color: #e74c3c; font-weight: bold; }
        button { background: #27ae60; color: white; border: none; padding: 10px; width: 100%; cursor: pointer; border-radius: 5px; font-weight: bold; }
        button:hover { background: #2ecc71; }
        input[type="file"] { margin-bottom: 15px; color: #ecf0f1; }
    </style>
</head>
<body>

    <div id="sidebar">
        <h2>EcoOrbit AI üõ∞Ô∏è</h2>
        <p>–°–∏—Å—Ç–µ–º–∞ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ª–µ—Å–æ–≤ –ü–∞–≤–ª–æ–¥–∞—Ä—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏</p>
        
        <form action="/" method="post" enctype="multipart/form-data">
            <input type="file" name="image" accept="image/*" required>
            <button type="submit">–ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –ò–ò</button>
        </form>

        {% if area %}
        <div class="stat-card">
            <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞:</h3>
            <p>–°—Ç–∞—Ç—É—Å: <span class="danger">–û–±–Ω–∞—Ä—É–∂–µ–Ω –ø–æ–∂–∞—Ä!</span></p>
            <p>–ú–µ—Å—Ç–æ: <strong>–≥. –ü–∞–≤–ª–æ–¥–∞—Ä</strong></p>
            <p>–ü–ª–æ—â–∞–¥—å: <strong>{{ area }} –ì–∞</strong></p>
            <p>–£—â–µ—Ä–± (–ø—Ä–æ–≥–Ω–æ–∑): <br>
               <span class="danger" style="font-size: 1.2em;">{{ money }} KZT</span>
            </p>
        </div>
        {% endif %}
    </div>

    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
    // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã —Å—Ä–∞–∑—É –Ω–∞ –ü–∞–≤–ª–æ–¥–∞—Ä
    var map = L.map('map').setView([52.2873, 76.9671], 10); 

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap contributors'
    }).addTo(map);

    // 2. –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–∂–∞—Ä–∞ –∏–∑ Flask (–≤–∞–∂–Ω–æ: –ë–ï–ó –ø—Ä–æ–ø—É—Å–∫–æ–≤ –∫–æ–¥–∞!)
    var fireStatus = "{{ 'true' if area else 'false' }}";

    if (fireStatus === "true") {
        var lat = 52.2873; 
        var lon = 76.9671; 
        
        var marker = L.marker([lat, lon]).addTo(map)
            .bindPopup('<b>–í–Ω–∏–º–∞–Ω–∏–µ!</b><br>–û—á–∞–≥ –≤–æ–∑–≥–æ—Ä–∞–Ω–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω –≤ –ü–∞–≤–ª–æ–¥–∞—Ä–µ.')
            .openPopup();

        map.setView([lat, lon], 14);
    }
    </script>

</body>
</html>